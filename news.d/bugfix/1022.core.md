Fix updating a dictionary mapping: ensure reverse lookups data stays consistent.
